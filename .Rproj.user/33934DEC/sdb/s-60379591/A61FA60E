{
    "collab_server" : "",
    "contents" : "#' Summarizing simulation results from a dec.sim object\n#' @description \\code{summary} method for class \\code{\"dec.sim\"}.\n#' @param object an object of class \\code{\"dec.sim\"}, a result of a call to \\code{dec.sim} or \\code{sl.sim}.\n#' @param pt target toxicity for each scenario.\n#' @param ... Not used argument.\n#' @import stats\n#' @export\n\nsummary.dec.sim <- function(object, pt, ...) {\n  if(missing(pt)) {\n    stop(\"Missing true toxicity.\")\n  }\n  if(class(object)[1] == \"sl.sim\" & length(object) != length(pt)) {\n    warning(\"only returns the first scenario stats\")\n  }\n  cat(\"Truth: True Toxicity Probability;\", \"\\n\")\n  cat(\"Prob: The probability of selecting each dose level as the MTD;\", \"\\n\")\n  cat(\"NP:  The average number of patients treated at each dose level.\", \"\\n\\n\")\n  ns <- length(pt)\n  avg.np <- rep(0, ns)\n  avg.dose <- rep(0, ns)\n  avg.prob <- rep(0, ns)\n  out <- vector(\"list\", ns)\n  for(i in 1:ns) {\n    if(class(object)[1] == \"sl.sim\"){\n      ans <- object[[i]]\n    } else {\n      ans <- object\n    }\n    truep <- ans$truep\n    n_dose <- length(truep)\n    res <- matrix(0, n_dose, 4)\n    colnames(res) <- c(\"Level\", \"Truth\", \"Prob.\", \"NP\")\n    res[, 1] <- 1:n_dose\n    res[, 2] <- truep\n    res[, 3] <- sapply(1:n_dose, function(ii) mean(ans$MTD==ii))\n    res[, 4] <- ans$n.patients\n    # calculate stats\n    avg.np[i] <- sum(res[, 4])\n    avg.dose[i] <- res[, 3][max(which(truep <= pt[i]))]\n    avg.prob[i] <-sum(res[, 4][truep <= pt[i]])/sum(res[, 4])\n    # table legends\n    cat(\"Scenario \", i, \"\\n\\n\")\n    cat(\"The average number of subjects:\", avg.np[i], \"\\n\")\n    cat(\"The probability of selecting the true MTD:\", avg.dose[i], \"\\n\")\n    cat(\"The probability of patients treated at or below the true MTD:\", avg.prob[i], \"\\n\\n\")\n    print(as.data.frame(res))\n    cat(\"\\n\")\n  }\n}\n",
    "created" : 1500322435681.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3061266430",
    "id" : "A61FA60E",
    "lastKnownWriteTime" : 1500322444,
    "last_content_update" : 1500322444858,
    "path" : "C:/Users/wguo25/Desktop/Package/tsdf/R/summary.dec.sim.R",
    "project_path" : "R/summary.dec.sim.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 10,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}